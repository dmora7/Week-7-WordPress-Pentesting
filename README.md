# Week-7-WordPress-Pentesting
Time spent: 12 hours spent in total

> Objective: Find, analyze, recreate, and document **four vulnerabilities** affecting an old version of WordPress

## Pentesting Report
**1. Authenticated Stored Cross-Site Scripting**
  - [x] Summary: An attacker with Contributor or Author account level privileges will format a special crafted HTML string containing JavaScript and will post it onto a WordPress page or post. The malicious script will then execute when an administrator visits or views the page.
    - Vulnerability types: Cross Site Scripting (XSS)
    - Tested in version: 4.2
    - Fixed in version: 4.2.3
  - [x] GIF Walkthrough: 
  ![xss](https://user-images.githubusercontent.com/37861847/40159358-d003c340-595d-11e8-9e7e-ebe58ac39b82.gif)
  - [x] Steps to recreate: 
  1. First, you will need to create a user account with 'Contributor' or 'Editor' level privileges. 
  2. Once created, log in to that account and copy and paste `<a href="[caption code=">]</a><a title=" onmouseover=alert('test')  ">link</a>` to a new post. 
  3.Publish the post and now on a different browser, log in as the administrator. 
  4. Navigate to the page or post where the line of code was placed and a pop up displaying `test` will appear. 
  5. Thus, you have successfully recreated this exploit. 
  - [x] Source:
    - [Cross Site Scripting Link](https://klikki.fi/adv/wordpress3.html)
    
**2. User Enumeration**
  - [x] Summary:  An attacker can utilize WPScan to discover vulnerbailities related to WordPress and with a well-crafted command, user accounts can be enumerated. Once the accounts are displayed, a message will display that the default username `admin` is still in use. With this information, the attacker can try logging in using admin as the username and admin as the password. 
    - Vulnerability types: User Enumeration
    - Tested in version: 4.2 
  - [x] GIF Walkthrough: 
  ![userenumeration](https://user-images.githubusercontent.com/37861847/40164927-b111f8c8-596f-11e8-90c5-4ede1967ac75.gif)
  - [x] Steps to recreate: 
  1. On Kali Linux, open a terminal window and run the following code: `wpscan --url wpdistillery.vm --enumerate u`.
  2. Once the users are listed, look out for the default **admin** username.
  3. If **admin** is displayed, log in using the username admin and the password admin.
  4. If **admin** is not displayed, other means can be implemented to crack passwords for accounts that were enumerated using WPScan.
  - [x] Source:
    - [User Enumeration Link](https://www.wpwhitesecurity.com/wordpress-security/enumerate-wordpress-users-wpscan-security-scanner/)
    
**3. Privilege Escalation**
  - [x] Summary: Users without sufficient privileges may submit comments that require approval from an administrator or moderator before their comments are published onto the site. With this attack, the attacker can submit one comment and await approval. Once approved, the attacker is able to bypass the approval stage and his/her comments no longer need to be approved. Opening up a vector for SQLi attacks where comments can be published without an administrator first approving them.
    - Vulnerability types: Privilege Escalation
    - Tested in version: 4.2
  - [x] GIF Walkthrough: 
  ![privlegeescalation](https://user-images.githubusercontent.com/37861847/40164125-971464c6-596d-11e8-8973-7be88576d48d.gif)
  - [x] Steps to recreate: 
  1. As a user with a subscriber account level, the attacker will need to submit a comment on a page or post.
  2. The administrator will now need to approve the attacker's comment.
  3. Once approved, the attacker can sumbit comments without having to wait for approval.
  4. In the administrator console, the comments will automatically be approved without user interaction.
  - [x] Source: N/A
 
**4. Host Header Injection in Password Reset**
  - [x] Summary: An attacker can modify the host header in the email request so that the attacker may intercept the password reset email link. With a successful exploit, the attacker can gain unauthorized access to the user's account.
    - Vulnerability types: Host Header Attack
    - Tested in version: 4.2
    - Fixed in version: 4.7.4
  - [x] GIF Walkthrough: N/A Was not able to replicate the exploit due to no email functionality. 
  - [x] Steps to recreate: 
  1. Attacker needs to send a modified request with their hostname as the HOST Header
  2. The change of the email's From/Return-Path will send an email from the attacker's malicious host address.
  3. The attacker will then be able to intercept that email that contains the password reset link and gain authorized access.
  - [x] Source:
    - [Host Header Link](https://exploitbox.io/vuln/WordPress-Exploit-4-7-Unauth-Password-Reset-0day-CVE-2017-8295.html) 
	

## Resources

- [WordPress Source Browser](https://core.trac.wordpress.org/browser/)
- [WordPress Developer Reference](https://developer.wordpress.org/reference/)

GIFs created with [LiceCap](http://www.cockos.com/licecap/).

## Notes

The theme I had installed during this testing was theme twentyfourteen version 1.4.
Kali Linux and WPScan were also essential tools used.

## License

    Copyright 2018 Apache

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
