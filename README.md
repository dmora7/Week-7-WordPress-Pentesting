# Week-7-WordPress-Pentesting
Time spent: 12 hours spent in total

> Objective: Find, analyze, recreate, and document **five vulnerabilities** affecting an old version of WordPress

## Pentesting Report
1. Authenticated Stored Cross-Site Scripting 
  - [x] Summary: An attacker with Contributor or Author account level privileges will format a special crafted HTML string containing JavaScript and will post it onto a WordPress page or post. The malicious script will then execute when an administrator visits or views the page.
    - Vulnerability types: Cross Site Scripting (XSS)
    - Tested in version: 4.2
    - Fixed in version: 4.2.3
  - [x] GIF Walkthrough: 
  ![xss](https://user-images.githubusercontent.com/37861847/40159358-d003c340-595d-11e8-9e7e-ebe58ac39b82.gif)
  - [x] Steps to recreate: 
  1. First, you will need to create a user account with 'Contributor' or 'Editor' level privileges. 
  2. Once created, log in to that account and copy and paste `<a href="[caption code=">]</a><a title=" onmouseover=alert('test')  ">link</a>` to a new post. 
  3.Publish the post and now on a different browser, log in as the administrator. 
  4. Navigate to the page or post where the line of code was placed and a pop up displaying `test` will appear. 
  5. Thus, you have successfully recreated this exploit. 
  - [x] Source:
    - [Link 1](https://klikki.fi/adv/wordpress3.html)
    
2. User Enumeration
  - [x] Summary:  An attacker can utilize WPScan to discover vulnerbailities related to WordPress and with a well-crafted command, user accounts can be enumerated. Once the accounts are displayed, a message will display that the default username `admin` is still in use. With this information, the attacker can try logging in using admin as the username and admin as the password. 
    - Vulnerability types: User Enumeration
    - Tested in version: 4.2 
  - [x] GIF Walkthrough: 
  ![userenumeration](https://user-images.githubusercontent.com/37861847/40164927-b111f8c8-596f-11e8-90c5-4ede1967ac75.gif)

  - [x] Steps to recreate: 
  1. On Kali Linux, open a terminal window and run the following code: `wpscan --url wpdistillery.vm --enumerate u`.
  2. Once the users are listed, look out for the default **admin** username.
  3. If **admin** is displayed, log in using the username admin and the password admin.
  4. If **admin** is not displayed, other means can be implemented to crack passwords for accounts that were enumerated using WPScan.
  - [x] Source:
    - [Link 1](https://www.wpwhitesecurity.com/wordpress-security/enumerate-wordpress-users-wpscan-security-scanner/)
3. Privilege Escalation
  - [ ] Summary: 
    - Vulnerability types: Privilege Escalation
    - Tested in version: 4.2
    - Fixed in version: 
  - [ ] GIF Walkthrough: 
  ![privlegeescalation](https://user-images.githubusercontent.com/37861847/40164125-971464c6-596d-11e8-8973-7be88576d48d.gif)

  - [ ] Steps to recreate: 
  1. 
  - [ ] Affected source code:
    - [Link 1](https://core.trac.wordpress.org/browser/tags/version/src/source_file.php)

	
	Attacker downloads a theme file and extracts the theme to change the 
	name of the theme to include a javascript payload in the name.
  The attacker then uploads the theme media as a zip file and when a user downloads 
  that specific theme, the file will decompress and execute the exploit

## Assets

List any additional assets, such as scripts or files

## Resources

- [WordPress Source Browser](https://core.trac.wordpress.org/browser/)
- [WordPress Developer Reference](https://developer.wordpress.org/reference/)

GIFs created with [LiceCap](http://www.cockos.com/licecap/).

## Notes

Describe any challenges encountered while doing the work

## License

    Copyright [yyyy] [name of copyright owner]

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
